# 2024-01-16 时间线笔记心情功能设计

## 1. 概述
在笔记应用中增加“心情”维度。用户在发布笔记时可以选择心情（晴/阴/雨），心情将在主页时间轴圆点和详情页图标中体现。

## 2. 数据结构
修改 `Note` 数据模型，增加 `mood` 字段。

```javascript
// 笔记对象结构
{
    id: 1,
    text: "...",
    timestamp: 1705380000000,
    mood: 'cloudy', // 新增字段：'sunny' | 'cloudy' | 'rainy'
    // ...其他现有字段
}
```

*   **默认值：** `cloudy` (阴天)
*   **兼容性：** 旧数据的 `mood` 字段可能不存在，显示时视为默认值 `cloudy`。

## 3. UI/UX 设计

### 3.1. 颜色系统 (CSS Variables)
复用已定义的颜色变量：
*   `--mood-sunny`: #FF9500 (橙色)
*   `--mood-cloudy`: #8E8E93 (灰色 - 默认)
*   `--mood-rainy`: #5856D6 (紫蓝色)

### 3.2. 创建笔记 (Compose Modal)
*   **入口：** 在底部工具栏（图片和标签按钮旁）增加一个“心情”按钮（笑脸图标）。
*   **交互：**
    *   点击按钮，在按钮正上方弹出一个小型气泡菜单（类似 iOS 长按菜单）。
    *   菜单内横向排列三个图标：☀️ ☁️ 🌧️。
    *   **默认状态：** 打开弹窗时，默认选中“阴天”。
    *   **选中反馈：** 选中的图标高亮显示对应颜色，气泡菜单自动关闭或保持打开供修改。
    *   **图标变化：** 底部工具栏的入口图标会实时变为当前选中的心情图标和颜色。

### 3.3. 主界面卡片 (Timeline)
*   **表现元素：** 时间轴上的圆点 (`.note-dot`)。
*   **逻辑优先级：**
    1.  **已收藏 (`is-favorite`)：** 圆点显示为**金色** (`--ios-yellow`)，忽略心情颜色。
    2.  **未收藏：** 圆点显示为**心情颜色**。
        *   Sunny -> 橙色
        *   Cloudy -> 灰色
        *   Rainy -> 紫蓝色

### 3.4. 详情页 (Detail Modal)
*   **位置：** 在 `.detail-meta` 区域，日期的左侧或右侧。
*   **样式：** 显示对应的简笔画 SVG 图标（无填充，线条风格，颜色对应心情色）。
*   **尺寸：** 约 16x16px 或 18x18px，与文字视觉平衡。

## 4. SVG 图标定义
需绘制三套简笔画 SVG：
1.  **Sunny:** 中心空心圆 + 8条短射线。
2.  **Cloudy:** 经典的云朵轮廓。
3.  **Rainy:** 云朵轮廓 + 下方3滴雨点。

## 5. 实现步骤
1.  **SVG 准备：** 在 HTML 中定义 SVG defs 或直接封装 Vue 组件/函数。
2.  **CSS 更新：** 添加心情相关的颜色类和选择器气泡样式。
3.  **JS 逻辑 (Compose)：** 增加 `mood` 状态管理，实现选择逻辑。
4.  **JS 逻辑 (Render)：** 修改主页渲染逻辑，根据 `mood` 和 `favorite` 计算圆点样式。
5.  **JS 逻辑 (Detail)：** 在详情页注入心情图标。
6.  **存储：** 确保存储和读取逻辑包含 `mood` 字段。
